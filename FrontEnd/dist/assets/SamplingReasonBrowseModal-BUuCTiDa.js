var e=Object.defineProperty,s=Object.defineProperties,r=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(s,r,t)=>r in s?e(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t,n=(e,s)=>{for(var r in s||(s={}))a.call(s,r)&&i(e,r,s[r]);if(t)for(var r of t(s))l.call(s,r)&&i(e,r,s[r]);return e},o=(e,t)=>s(e,r(t));import{r as c,s as d,j as x,F as m,a as g,b as h,c as u,d as p,e as b,f}from"./index-Dnee4v6m.js";const v={search:"",isActive:!0},j={reasons:[],filteredReasons:[],loading:!1,error:null},y=({isOpen:e,onClose:s,onReasonSelect:r,selectedReason:t})=>{const[a,l]=c.useState(o(n({},j),{filters:v}));c.useEffect(()=>{e&&i()},[e]),c.useEffect(()=>{y()},[a.reasons,a.filters]);const i=()=>{return e=void 0,s=null,r=function*(){l(e=>o(n({},e),{loading:!0,error:null}));try{const e=yield d.get({isActive:!0});if(e.success&&e.data){const s=e.data.map(e=>{var s,r;return{id:e.id,name:e.name,description:e.description,isActive:null==(r=null!=(s=e.is_active)?s:e.isActive)||r,created_by:e.created_by,updated_by:e.updated_by,created_at:e.created_at,updated_at:e.updated_at}});l(e=>o(n({},e),{reasons:s,loading:!1}))}else l(s=>o(n({},s),{error:e.error||"Failed to load sampling reasons",loading:!1}))}catch(e){console.error("Failed to load sampling reasons:",e),l(e=>o(n({},e),{error:"Network error: Failed to connect to server",loading:!1}))}},new Promise((t,a)=>{var l=e=>{try{n(r.next(e))}catch(s){a(s)}},i=e=>{try{n(r.throw(e))}catch(s){a(s)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(l,i);n((r=r.apply(e,s)).next())});var e,s,r},y=()=>{let e=[...a.reasons];if(a.filters.search.trim()){const s=a.filters.search.toLowerCase().trim();e=e.filter(e=>{var r;return e.name.toLowerCase().includes(s)||(null==(r=e.description)?void 0:r.toLowerCase().includes(s))})}null!==a.filters.isActive&&(e=e.filter(e=>e.isActive===a.filters.isActive)),l(s=>o(n({},s),{filteredReasons:e}))},N=(e,s)=>{l(r=>o(n({},r),{filters:o(n({},r.filters),{[e]:s})}))},w=()=>{l(e=>o(n({},e),{filters:v}))},A=e=>{e.isActive&&r(e)},C=c.useMemo(()=>Object.values(a.filters).some(e=>null!==e&&""!==e&&!0!==e),[a.filters]),S=e=>{if(!e)return"";try{return new Date(e).toLocaleDateString()}catch(s){return""}};return e?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:x.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[x.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[x.jsxs("div",{className:"flex items-center",children:[x.jsx(m,{className:"h-6 w-6 text-orange-500 mr-3"}),x.jsxs("div",{children:[x.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Select Sampling Reason"}),x.jsx("p",{className:"text-sm text-gray-600",children:"Choose the appropriate reason for this inspection"})]})]}),x.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:x.jsx(g,{className:"h-6 w-6"})})]}),x.jsxs("div",{className:"p-6 border-b border-gray-200 bg-gray-50",children:[x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),x.jsxs("div",{className:"relative",children:[x.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),x.jsx("input",{type:"text",value:a.filters.search,onChange:e=>N("search",e.target.value),placeholder:"Search by name or description...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),x.jsxs("select",{value:null===a.filters.isActive?"":a.filters.isActive.toString(),onChange:e=>N("isActive",""===e.target.value?null:"true"===e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[x.jsx("option",{value:"",children:"All Status"}),x.jsx("option",{value:"true",children:"Active Only"}),x.jsx("option",{value:"false",children:"Inactive Only"})]})]})]}),C&&x.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[x.jsxs("div",{className:"text-sm text-gray-600",children:[a.filteredReasons.length," of ",a.reasons.length," reasons shown"]}),x.jsxs("button",{onClick:w,className:"flex items-center space-x-1 px-3 py-1 text-sm text-orange-600 hover:text-orange-700",children:[x.jsx(g,{className:"h-4 w-4"}),x.jsx("span",{children:"Clear Filters"})]})]})]}),x.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:a.loading?x.jsx("div",{className:"flex items-center justify-center py-12",children:x.jsxs("div",{className:"text-center",children:[x.jsx(u,{className:"h-8 w-8 animate-spin text-orange-500 mx-auto mb-4"}),x.jsx("p",{className:"text-gray-600",children:"Loading sampling reasons..."})]})}):a.error?x.jsxs("div",{className:"text-center py-12",children:[x.jsx(p,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),x.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Failed to Load Sampling Reasons"}),x.jsx("p",{className:"text-gray-600 mb-4",children:a.error}),x.jsx("button",{onClick:i,className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600",children:"Try Again"})]}):0===a.filteredReasons.length?x.jsxs("div",{className:"text-center py-12",children:[x.jsx(m,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),x.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No sampling reasons found"}),x.jsx("p",{className:"text-gray-600 mb-4",children:C?"Try adjusting your filters or search terms":"No sampling reasons are currently available"}),C&&x.jsx("button",{onClick:w,className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600",children:"Clear All Filters"})]}):x.jsxs("div",{children:[x.jsxs("div",{className:"flex items-center justify-between mb-6",children:[x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsx(b,{className:"h-5 w-5 text-orange-500"}),x.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Available Sampling Reasons"}),x.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 text-sm rounded-full",children:a.filteredReasons.length})]}),x.jsxs("button",{onClick:i,className:"flex items-center space-x-1 px-3 py-1 text-sm text-gray-600 hover:text-gray-700",children:[x.jsx(u,{className:"h-4 w-4"}),x.jsx("span",{children:"Refresh"})]})]}),x.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:a.filteredReasons.map(e=>x.jsxs("div",{onClick:()=>A(e),className:`\n                      relative p-4 border-2 rounded-lg cursor-pointer transition-all duration-200 hover:shadow-md\n                      ${e.isActive?(null==t?void 0:t.id)===e.id?"border-orange-500 bg-orange-50 shadow-md":"border-gray-200 hover:border-orange-300 bg-white":"opacity-50 cursor-not-allowed border-gray-200 bg-gray-50"}\n                    `,children:[(null==t?void 0:t.id)===e.id&&x.jsx("div",{className:"absolute top-2 right-2",children:x.jsx(f,{className:"h-5 w-5 text-orange-500"})}),x.jsxs("div",{className:"mb-3",children:[x.jsx("h4",{className:"font-medium text-gray-900 text-sm leading-tight mb-1",children:e.name}),x.jsxs("p",{className:"text-xs text-gray-600",children:["ID: #",e.id]})]}),e.description&&x.jsx("p",{className:"text-xs text-gray-600 mb-3 line-clamp-3 leading-relaxed",children:e.description}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+(e.isActive?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:e.isActive?"Active":"Inactive"}),e.created_at&&x.jsx("span",{className:"text-xs text-gray-500",children:S(e.created_at)})]})]},e.id))})]})}),x.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[x.jsx("div",{className:"text-sm text-gray-600",children:t?`Selected: ${t.name} (#${t.id})`:"No reason selected"}),x.jsxs("div",{className:"flex space-x-3",children:[x.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),t&&x.jsx("button",{onClick:()=>A(t),className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors",children:"Confirm Selection"})]})]})]})}):null};export{y as default};
